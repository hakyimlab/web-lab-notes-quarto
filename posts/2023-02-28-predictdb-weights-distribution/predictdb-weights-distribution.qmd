---
title: "PredictDB weight distribution"
author: "Haky Im"
date: "2023-02-28"
categories: [analysis]
format:
  html:
    code-fold: true
    code-summary: "Show the code"
editor_options: 
  chunk_output_type: console
---

Goal: get effect size distribution of omic traits



```{r preliminary definitions}
suppressMessages(library(tidyverse))
suppressMessages(library(glue))
PRE = "/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data"
##PRE="/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data "
##PRE="/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data"
## COPY THE DATE AND SLUG fields FROM THE HEADER
SLUG="predictdb-weight-distribution" ## copy the slug from the header
bDATE='2023-02-28' ## copy the date from the blog's header here
DATA = glue("{PRE}/{bDATE}-{SLUG}")
if(!file.exists(DATA)) system(glue::glue("mkdir {DATA}"))
WORK=DATA

## move data to DATA
#tempodata=("~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv")
#system(glue::glue("cp {tempodata} {DATA}/"))
## system(glue("open {DATA}")) ## this will open the folder 
```

-   [ ] download mashr gtex v8 prediction models for various

```{r, eval=FALSE}
setwd(DATA)
system(glue("wget https://zenodo.org/record/3518299/files/mashr_eqtl.tar?download=1"))
system(glue("tar xvf mashr_eqtl.tar"))
system(glue("cd eqtl"))
system("rm *.txt.gz")
```


-   [ ] plot distribution, show summary

```{r}

library("RSQLite")
sqlite <- dbDriver("SQLite")

myshowdist = function(dbname,titulo="n=")
{
print(dbname)
db = dbConnect(sqlite,dbname)
weights = dbGetQuery(db, "select * from weights")
eightylines = quantile(weights$weight,c(0.1,0.9))
print( quantile(weights$weight,(0:10)/10) )
pp <- ggplot(weights,aes(weight))+geom_histogram() + geom_vline(xintercept=eightylines) +ggtitle(titulo) +theme_bw(base_size = 15)
print(pp)
dbDisconnect(db)
}
```

-   [ ] read weights adipose with 491 samples
```{r}
dbname <- glue("{DATA}/eqtl/mashr_Adipose_Subcutaneous.db") ## add full path if db file not in current directory
myshowdist(dbname,titulo="n=491")
```

- [ ] read weights brain substantia nigra with 101 samples

```{r}
dbname <- glue("{DATA}/eqtl/mashr_Brain_Substantia_nigra.db") ## add full path if db file not in current directory
myshowdist(dbname,titulo="n=101")
```







  name                                          european samples abbreviation     expression models   splicing models
  ------------------------------------------- ------------------ -------------- ------------------- -----------------
  Adipose - Subcutaneous                                     491 ADPSBQ                       14732             42912
  Adipose - Visceral (Omentum)                               401 ADPVSC                       14640             41720
  Adrenal Gland                                              200 ADRNLG                       13622             36754
  Artery - Aorta                                             338 ARTAORT                      14396             40474
  Artery - Coronary                                          180 ARTCRN                       13878             40579
  Artery - Tibial                                            489 ARTTBL                       14493             40690
  Brain - Amygdala                                           119 BRNAMY                       12814             24236
  Brain - Anterior cingulate cortex (BA24)                   135 BRNACC                       13528             28806
  Brain - Caudate (basal ganglia)                            172 BRNCDT                       14118             32127
  Brain - Cerebellar Hemisphere                              157 BRNCHB                       13771             39862
  Brain - Cerebellum                                         188 BRNCHA                       13992             40747
  Brain - Cortex                                             184 BRNCTXA                      14284             35086
  Brain - Frontal Cortex (BA9)                               158 BRNCTXB                      14091             32031
  Brain - Hippocampus                                        150 BRNHPP                       13526             27437
  Brain - Hypothalamus                                       157 BRNHPT                       13741             30326
  Brain - Nucleus accumbens (basal ganglia)                  181 BRNNCC                       14062             32670
  Brain - Putamen (basal ganglia)                            153 BRNPTM                       13694             28461
  Brain - Spinal cord (cervical c-1)                         115 BRNSPC                       13096             28883
  Brain - Substantia nigra                                   101 BRNSNG                       12637             23677
  Breast - Mammary Tissue                                    337 BREAST                       14654             44613
  Cells - Cultured fibroblasts                               417 FIBRBLS                      13976             36809
  Cells - EBV-transformed lymphocytes                        116 LCL                          12398             37627
  Colon - Sigmoid                                            274 CLNSGM                       14363             41581
  Colon - Transverse                                         306 CLNTRN                       14582             41215
  Esophagus - Gastroesophageal Junction                      281 ESPGEJ                       14285             41004
  Esophagus - Mucosa                                         423 ESPMCS                       14589             37186
  Esophagus - Muscularis                                     399 ESPMSL                       14603             40376
  Heart - Atrial Appendage                                   322 HRTAA                        14035             36322
  Heart - Left Ventricle                                     334 HRTLV                        13200             29470
  Kidney - Cortex                                             65 KDNCTX                       11164             24571
  Liver                                                      183 LIVER                        12714             27011
  Lung                                                       444 LUNG                         15058             44346
  Minor Salivary Gland                                       119 SLVRYG                       13884             38380
  Muscle - Skeletal                                          602 MSCLSK                       13381             31855
  Nerve - Tibial                                             449 NERVET                       15373             45478
  Ovary                                                      140 OVARY                        13738             40857
  Pancreas                                                   253 PNCREAS                      13695             31203
  Pituitary                                                  219 PTTARY                       14647             42343
  Prostate                                                   186 PRSTTE                       14450             41991
  Skin - Not Sun Exposed (Suprapubic)                        440 SKINNS                       14932             42005
  Skin - Sun Exposed (Lower leg)                             517 SKINS                        15204             42219
  Small Intestine - Terminal Ileum                           144 SNTTRM                       14065             39864
  Spleen                                                     186 SPLEEN                       14073             40290
  Stomach                                                    269 STMACH                       14102             36624
  Testis                                                     277 TESTIS                       17867             67784
  Thyroid                                                    494 THYROID                      15303             45217
  Uterus                                                     108 UTERUS                       13199             39485
  Vagina                                                     122 VAGINA                       12969             36931
  Whole Blood                                                573 WHLBLD                       12623             24568