{
  "hash": "1aafdd4d1cdba21998db35be0b9d0b10",
  "result": {
    "markdown": "---\ntitle: \"BrainXcan supplementary tables content\"\nauthor: \"Haky Im\"\ndate: \"2023-08-09\"\neditor_options: \n  chunk_output_type: console\n---\n\n\n:::{.callout-tip}\n## Summary\nTrying to get a sense of what we have in the supplementary tables.\n:::\n\n\n:::{.callout-warning collapse=\"true\"}\n## Note\nTable S6 has results from brainxcan in 9 ukb phenotypes\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\nSLUG=\"brainxcan-supplementary-tables-content\" ## copy the slug from the header\nbDATE='2023-08-09' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n##system(glue(\"open {DATA}\")) ## this will open the folder \n\n## load qqunif\ndevtools::source_gist(\"38431b74c6c0bf90c12f\")\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nℹ Sourcing gist \"38431b74c6c0bf90c12f\"\nℹ SHA-1 hash of file is \"7534a04652d34154de13d2fa2ac042adb0d1f564\"\n```\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nsystem(glue(\"ls -r {DATA}/*\"))\n```\n:::\n\n\n## load 2022-11-17 tables\n\n::: {.cell}\n\n```{.r .cell-code}\n# stab2 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S2.xlsx\"))\n# stab3 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S3.xlsx\"))\n# stab4 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S4.xlsx\"))\n# stab5 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S5.xlsx\"))\n# stab6 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S6.xlsx\"))\n# stab7 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S7.xlsx\"))\n# stab8 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S8.xlsx\"))\n# stab8factor = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S8-w-factor.xlsx\"))\n# stab9 = readxl::read_excel(glue(\"{DATA}/revision_plos_gen_20221117/Table_S9.xlsx\"))\n```\n:::\n\n\n## load 2023-08-11 tables\n\n::: {.cell}\n\n```{.r .cell-code}\nstab2 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S2.xlsx\"))\nstab3 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S3.xlsx\"))\nstab4 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S4.xlsx\"))\nstab5 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S5.xlsx\"))\nstab6 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S6.xlsx\"))\nstab7 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S7.xlsx\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3746 / R3746C6: 'Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3747 / R3747C6: '-Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3748 / R3748C6: 'Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3749 / R3749C6: '-Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3750 / R3750C6: 'Inf'\n```\n:::\n\n```{.r .cell-code}\nstab7wofactor = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S7-wo-factor.xlsx\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3746 / R3746C6: 'Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3747 / R3747C6: '-Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3748 / R3748C6: 'Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3749 / R3749C6: '-Inf'\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Coercing text to numeric in F3750 / R3750C6: 'Inf'\n```\n:::\n\n```{.r .cell-code}\nstab8 = readxl::read_excel(glue(\"{DATA}/updated-to-2023-08-11/Table_S8.xlsx\"))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nphenolist = unique(stab7$phenotype)\nmydata=stab7\nfor(pheno in phenolist)\n{\n  qqunif(mydata$pval_adj_perm_null[mydata$model==\"ridge\" & mydata$phenotype== pheno],main=pheno)\n  mtext(\"perm and factor adjusted\")\n}\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-1.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-2.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-4.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-5.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-6.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in qqunif(mydata$pval_adj_perm_null[mydata$model == \"ridge\" &\nmydata$phenotype == : thresholding p to 1e-30\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-7.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in qqunif(mydata$pval_adj_perm_null[mydata$model == \"ridge\" &\nmydata$phenotype == : thresholding p to 1e-30\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-8.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-9.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-10.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-11.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning in qqunif(mydata$pval_adj_perm_null[mydata$model == \"ridge\" &\nmydata$phenotype == : thresholding p to 1e-30\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-12.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-13.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-14.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-15.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-16.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-17.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-18.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-19.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-20.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-21.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-22.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-23.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-24.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-25.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-26.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-27.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-28.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-29.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-30.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-31.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-32.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-33.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-34.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/qqunif of 35 traits-35.png){width=672}\n:::\n:::\n\n\n## plot zscores for dMRI\n\n::: {.cell}\n\n```{.r .cell-code}\ntable(stab2$pc1_name,useNA='always')\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n\n                    NA        PC-Cerebellum-1          PC-Cortical-1 \n                     7                     28                     96 \n     PC-FA-ProbTrack-1           PC-FA-TBSS-1    PC-ICVF-ProbTrack-1 \n                    27                     48                     27 \n        PC-ICVF-TBSS-1   PC-ISOVF-ProbTrack-1        PC-ISOVF-TBSS-1 \n                    48                     27                     48 \n     PC-OD-ProbTrack-1           PC-OD-TBSS-1 PC-Subcortical_GMvol-1 \n                    27                     48                     14 \n  PC-Subcortical_vol-1                   <NA> \n                    14                      0 \n```\n:::\n\n```{.r .cell-code}\nstab7 %>% \n  inner_join(stab2 %>% \n               filter(modality==\"dMRI\", \n                      measurement_type==\"dMRI skeleton (TBSS-style measurement)\") %>% \n               select(IDP,region,subtype)) %>% \n  filter(model==\"ridge\") %>% \n  filter(subtype==\"ICVF\") %>% \n  select(IDP,pheno=phenotype,z=z_adj_perm_null) %>% \n  ggplot(aes(IDP,pheno,fill=z))  + geom_tile()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(IDP)`\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# ##install.packages(\"RColorBrewer\")\n# suppressMessages(library(\"RColorBrewer\"))\n\n\n  \nmyplot <- function(subtipo)\n{df <- stab7 %>% \n  inner_join(stab2 %>% \n               filter(modality==\"dMRI\", \n                      measurement_type==\"dMRI skeleton (TBSS-style measurement)\") %>% \n               select(IDP,region,subtype)) %>% \n  filter(model==\"ridge\") %>% \n  filter(subtype==subtipo) \n\n\n# Define significance labels\ndf <- df %>%\n  select(IDP, pheno = phenotype, z = z_adj_perm_null) %>%\n  mutate(significance = case_when(\n    abs(z) > 4 ~ \"*\",\n    abs(z) <= 4 & abs(z) > 2 ~ \"\\u00B7\",  # Use MIDDLE DOT\n    TRUE ~ \"\"\n  ))\n\n# Plot\npp <- ggplot(df, aes(x = IDP, y = pheno)) +\n  geom_tile(aes(fill = z)) + \n  geom_text(aes(label = significance), vjust = 0.5, hjust = 0.5) +\n  scale_fill_gradient2(low = \"blue\", mid = \"white\", high = \"red\", midpoint = 0) +\n  labs(fill = \"z-value\") +\n  theme_minimal() +\n  theme(axis.text.x = element_text(angle = 90, hjust = 1, vjust = 0.5)) +\n  ggtitle(subtipo)\n\nprint(pp)\n}\n\n\nfor(subtipo in c(\"FA\",\"ICVF\",\"OD\",\"ISOVF\"))\n{\n  myplot(subtipo)\n}\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(IDP)`\nJoining with `by = join_by(IDP)`\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(IDP)`\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-2.png){width=672}\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nJoining with `by = join_by(IDP)`\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-3.png){width=672}\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-6-4.png){width=672}\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}