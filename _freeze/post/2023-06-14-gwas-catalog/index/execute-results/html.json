{
  "hash": "6b26cd9640eb60e6632399031010a31b",
  "result": {
    "markdown": "---\ntitle: \"gwas-catalog\"\nauthor: \"Hae Kyung Im\"\ndate: \"2020-08-02\"\ndate-modified: last-modified\neditor_options: \n  chunk_output_type: console\n---\n\n\n## GWAS catalog\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressMessages(library(tidyverse))\n\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n\nSLUG=\"gwas-catalog\" ## copy the slug from the header\nbDATE='2020-08-02' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n##  system(glue(\"open {DATA}\")) ## this will open the folder \n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n## download fron https://www.ebi.ac.uk/gwas/api/search/downloads/alternative\n\n## DATA = \"/Users/haekyungim/Box/LargeFiles/imlab-data/data-Github/analysis-hki\"\ngwascat = read_tsv(glue(\"{DATA}/gwas_catalog_v1.0.2-associations_e109_r2023-06-03.tsv.gz\"), guess_max = 100000)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat <- vroom(...)\n  problems(dat)\n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 529481 Columns: 38\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr  (28): FIRST AUTHOR, JOURNAL, LINK, STUDY, DISEASE/TRAIT, INITIAL SAMPLE...\ndbl   (8): PUBMEDID, UPSTREAM_GENE_DISTANCE, DOWNSTREAM_GENE_DISTANCE, MERGE...\ndate  (2): DATE ADDED TO CATALOG, DATE\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n##\"gwas_catalog_v1.0.2-associations_e100_r2020-08-05.tsv\"\n##\"gwas_catalog_v1.0.2-associations_e100_r2020-07-14.tsv\"\n##\"gwas_catalog_v1.0.2-associations_e100_r2020-08-05.tsv\"\n\ndim(gwascat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 529481     38\n```\n:::\n\n```{.r .cell-code}\nglimpse(gwascat)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nRows: 529,481\nColumns: 38\n$ `DATE ADDED TO CATALOG`      <date> 2022-07-04, 2022-07-04, 2022-07-04, 2022…\n$ PUBMEDID                     <dbl> 33462482, 33462482, 33462482, 33462482, 3…\n$ `FIRST AUTHOR`               <chr> \"Ruhlemann MC\", \"Ruhlemann MC\", \"Ruhleman…\n$ DATE                         <date> 2021-01-18, 2021-01-18, 2021-01-18, 2021…\n$ JOURNAL                      <chr> \"Nat Genet\", \"Nat Genet\", \"Nat Genet\", \"N…\n$ LINK                         <chr> \"www.ncbi.nlm.nih.gov/pubmed/33462482\", \"…\n$ STUDY                        <chr> \"Genome-wide association study in 8,956 G…\n$ `DISEASE/TRAIT`              <chr> \"TestASV_20 (Phascolarctobacterium) preva…\n$ `INITIAL SAMPLE SIZE`        <chr> \"8,956 German ancestry individuals\", \"8,9…\n$ `REPLICATION SAMPLE SIZE`    <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ REGION                       <chr> \"9p21.3\", NA, NA, \"17q24.3\", \"20q13.31\", …\n$ CHR_ID                       <chr> \"9\", NA, NA, \"17\", \"20\", \"3\", NA, NA, \"11…\n$ CHR_POS                      <chr> \"22175189\", NA, NA, \"72438652\", \"56989649…\n$ `REPORTED GENE(S)`           <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ MAPPED_GENE                  <chr> \"CDKN2B-AS1 - DMRTA1\", NA, NA, \"LINC00511…\n$ UPSTREAM_GENE_ID             <chr> \"ENSG00000240498\", NA, NA, NA, \"ENSG00000…\n$ DOWNSTREAM_GENE_ID           <chr> \"ENSG00000176399\", NA, NA, NA, \"ENSG00000…\n$ SNP_GENE_IDS                 <chr> NA, NA, NA, \"ENSG00000227036\", NA, \"ENSG0…\n$ UPSTREAM_GENE_DISTANCE       <dbl> 47086, NA, NA, NA, 203562, NA, NA, NA, NA…\n$ DOWNSTREAM_GENE_DISTANCE     <dbl> 271635, NA, NA, NA, 179104, NA, NA, NA, N…\n$ `STRONGEST SNP-RISK ALLELE`  <chr> \"rs10965279-?\", \"chr11:60833276-?\", \"chr1…\n$ SNPS                         <chr> \"rs10965279\", \"chr11:60833276\", \"chr13:43…\n$ MERGED                       <dbl> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ SNP_ID_CURRENT               <chr> \"10965279\", NA, NA, \"7223271\", \"910832\", …\n$ CONTEXT                      <chr> \"intergenic_variant\", NA, NA, \"intron_var…\n$ INTERGENIC                   <dbl> 1, 1, 1, 0, 1, 0, 1, 1, 0, 0, 1, 0, 0, 1,…\n$ `RISK ALLELE FREQUENCY`      <chr> \"NR\", \"NR\", \"NR\", \"NR\", \"NR\", \"NR\", \"NR\",…\n$ `P-VALUE`                    <dbl> 5e-08, 2e-06, 9e-06, 9e-06, 8e-06, 3e-06,…\n$ PVALUE_MLOG                  <dbl> 7.301030, 5.698970, 5.045757, 5.045757, 5…\n$ `P-VALUE (TEXT)`             <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, N…\n$ `OR or BETA`                 <dbl> 0.5047070, 0.3521481, 0.3854320, 0.427226…\n$ `95% CI (TEXT)`              <chr> \"[0.32-0.69] unit increase\", \"[0.21-0.5] …\n$ `PLATFORM [SNPS PASSING QC]` <chr> \"NR [6900000] (imputed)\", \"NR [6900000] (…\n$ CNV                          <chr> \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"N\", \"…\n$ MAPPED_TRAIT                 <chr> \"gut microbiome measurement\", \"gut microb…\n$ MAPPED_TRAIT_URI             <chr> \"http://www.ebi.ac.uk/efo/EFO_0007874\", \"…\n$ `STUDY ACCESSION`            <chr> \"GCST90011694\", \"GCST90011694\", \"GCST9001…\n$ `GENOTYPING TECHNOLOGY`      <chr> \"Genome-wide genotyping array\", \"Genome-w…\n```\n:::\n\n```{.r .cell-code}\ngwascat %>% count(MAPPED_TRAIT,CHR_POS) %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 373864      3\n```\n:::\n\n```{.r .cell-code}\nlength(unique(gwascat$MAPPED_TRAIT))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 8723\n```\n:::\n\n```{.r .cell-code}\nlength(unique(gwascat$CHR_POS))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 256855\n```\n:::\n\n```{.r .cell-code}\n## 2023-06-14 256855 distinct trait/variants\n## 2023-06-14 8723 distinct traits\n## 2020 146,359 distinct trait/variant\n## 2020 3,758 distinct traits\n\ngwascat_sig = gwascat %>% mutate(year=as.factor(lubridate::year(lubridate::as_date(`DATE ADDED TO CATALOG`)))) %>% filter(`P-VALUE`<5e-8)\n\ngwascat_sig %>% filter(year!=\"2023\") %>% ggplot(aes(year)) + geom_bar() + theme_bw(base_size = 15) + scale_x_discrete(breaks=c(\"2008\",\"2012\",\"2016\",\"2020\",\"2022\")) + xlab(\"year\") + ylab(\"GWAS loci reported p<5e-8\") + ggtitle(\"GWAS Catalog Downloaded 2023-06-14\")\n```\n\n::: {.cell-output-display}\n![](index_files/figure-html/get the gwas catalog-1.png){width=672}\n:::\n\n```{.r .cell-code}\n##ggsave(glue::glue(\"{DATA}/gwas-catalog/gwas-catalog-by-year.pdf\"))\n```\n:::\n\n\n- [ ] number of significant SNPs\n\n::: {.cell}\n\n```{.r .cell-code}\ngwascat_sig %>% count(CHR_POS) %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 185850      2\n```\n:::\n:::\n\n\n- [ ] number of significant trait/SNP pairs\n\n::: {.cell}\n\n```{.r .cell-code}\ngwascat_sig %>% count(CHR_POS,MAPPED_TRAIT) %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 288566      3\n```\n:::\n:::\n\nin 2020 [1] 94664     3\n\n- [ ] number of traits with significant SNPs\n\n::: {.cell}\n\n```{.r .cell-code}\ngwascat_sig %>% count(MAPPED_TRAIT) %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 7427    2\n```\n:::\n:::\n\nin 2020 [1] 2584    2\n\n\n- [ ] number of unique studies\n\n::: {.cell}\n\n```{.r .cell-code}\ngwascat %>% count(STUDY) %>% dim()\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] 5605    2\n```\n:::\n:::\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}