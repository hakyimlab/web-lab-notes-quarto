{
  "hash": "fa9a5ece2f977906d84f5f82e613fc0d",
  "result": {
    "markdown": "---\ntitle: \"PredictDB weight distribution\"\nauthor: \"Haky Im\"\ndate: \"2023-02-28\"\ncategories: [analysis]\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\neditor_options: \n  chunk_output_type: console\n---\n\n\nGoal: get effect size distribution of omic traits\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n##PRE=\"/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data \"\n##PRE=\"/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data\"\n## COPY THE DATE AND SLUG fields FROM THE HEADER\nSLUG=\"predictdb-weight-distribution\" ## copy the slug from the header\nbDATE='2023-02-28' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n## move data to DATA\n#tempodata=(\"~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv\")\n#system(glue::glue(\"cp {tempodata} {DATA}/\"))\n## system(glue(\"open {DATA}\")) ## this will open the folder \n```\n:::\n\n\n-   [ ] download mashr gtex v8 prediction models for various\n\n\n::: {.cell}\n\n```{.r .cell-code}\nsetwd(DATA)\nsystem(glue(\"wget https://zenodo.org/record/3518299/files/mashr_eqtl.tar?download=1\"))\nsystem(glue(\"tar xvf mashr_eqtl.tar\"))\nsystem(glue(\"cd eqtl\"))\nsystem(\"rm *.txt.gz\")\n```\n:::\n\n\n\n-   [ ] plot distribution, show summary\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(\"RSQLite\")\nsqlite <- dbDriver(\"SQLite\")\n\nmyshowdist = function(dbname,titulo=\"n=\")\n{\nprint(dbname)\ndb = dbConnect(sqlite,dbname)\nweights = dbGetQuery(db, \"select * from weights\")\neightylines = quantile(weights$weight,c(0.1,0.9)) %>% round(2)\nquantile(weights$weight,(0:10)/10) %>% round(2) %>% print()\npp <- ggplot(weights,aes(weight))+geom_histogram() + geom_vline(xintercept=eightylines) +ggtitle(glue(\"{titulo}; {eightylines[1]} - {eightylines[2]}\"))\nprint(pp)\ndbDisconnect(db)\n}\n```\n:::\n\n\n-   [ ] read weights adipose with 491 samples\n\n::: {.cell}\n\n```{.r .cell-code}\ndbname <- glue(\"{DATA}/eqtl/mashr_Adipose_Subcutaneous.db\") ## add full path if db file not in current directory\nmyshowdist(dbname,titulo=\"n=491\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data/2023-02-28-predictdb-weight-distribution/eqtl/mashr_Adipose_Subcutaneous.db\n   0%   10%   20%   30%   40%   50%   60%   70%   80%   90%  100% \n-2.09 -0.34 -0.20 -0.12 -0.05  0.00  0.05  0.12  0.20  0.35  2.47 \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](predictdb-weights-distribution_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n- [ ] read weights brain substantia nigra with 101 samples\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndbname <- glue(\"{DATA}/eqtl/mashr_Brain_Substantia_nigra.db\") ## add full path if db file not in current directory\nmyshowdist(dbname,titulo=\"n=101\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data/2023-02-28-predictdb-weight-distribution/eqtl/mashr_Brain_Substantia_nigra.db\n   0%   10%   20%   30%   40%   50%   60%   70%   80%   90%  100% \n-2.56 -0.28 -0.14 -0.07 -0.02  0.00  0.02  0.07  0.14  0.29  2.40 \n```\n:::\n\n::: {.cell-output .cell-output-stderr}\n```\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n```\n:::\n\n::: {.cell-output-display}\n![](predictdb-weights-distribution_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n\n\n\n\n\n\n\n  name                                          european samples abbreviation     expression models   splicing models\n  ------------------------------------------- ------------------ -------------- ------------------- -----------------\n  Adipose - Subcutaneous                                     491 ADPSBQ                       14732             42912\n  Adipose - Visceral (Omentum)                               401 ADPVSC                       14640             41720\n  Adrenal Gland                                              200 ADRNLG                       13622             36754\n  Artery - Aorta                                             338 ARTAORT                      14396             40474\n  Artery - Coronary                                          180 ARTCRN                       13878             40579\n  Artery - Tibial                                            489 ARTTBL                       14493             40690\n  Brain - Amygdala                                           119 BRNAMY                       12814             24236\n  Brain - Anterior cingulate cortex (BA24)                   135 BRNACC                       13528             28806\n  Brain - Caudate (basal ganglia)                            172 BRNCDT                       14118             32127\n  Brain - Cerebellar Hemisphere                              157 BRNCHB                       13771             39862\n  Brain - Cerebellum                                         188 BRNCHA                       13992             40747\n  Brain - Cortex                                             184 BRNCTXA                      14284             35086\n  Brain - Frontal Cortex (BA9)                               158 BRNCTXB                      14091             32031\n  Brain - Hippocampus                                        150 BRNHPP                       13526             27437\n  Brain - Hypothalamus                                       157 BRNHPT                       13741             30326\n  Brain - Nucleus accumbens (basal ganglia)                  181 BRNNCC                       14062             32670\n  Brain - Putamen (basal ganglia)                            153 BRNPTM                       13694             28461\n  Brain - Spinal cord (cervical c-1)                         115 BRNSPC                       13096             28883\n  Brain - Substantia nigra                                   101 BRNSNG                       12637             23677\n  Breast - Mammary Tissue                                    337 BREAST                       14654             44613\n  Cells - Cultured fibroblasts                               417 FIBRBLS                      13976             36809\n  Cells - EBV-transformed lymphocytes                        116 LCL                          12398             37627\n  Colon - Sigmoid                                            274 CLNSGM                       14363             41581\n  Colon - Transverse                                         306 CLNTRN                       14582             41215\n  Esophagus - Gastroesophageal Junction                      281 ESPGEJ                       14285             41004\n  Esophagus - Mucosa                                         423 ESPMCS                       14589             37186\n  Esophagus - Muscularis                                     399 ESPMSL                       14603             40376\n  Heart - Atrial Appendage                                   322 HRTAA                        14035             36322\n  Heart - Left Ventricle                                     334 HRTLV                        13200             29470\n  Kidney - Cortex                                             65 KDNCTX                       11164             24571\n  Liver                                                      183 LIVER                        12714             27011\n  Lung                                                       444 LUNG                         15058             44346\n  Minor Salivary Gland                                       119 SLVRYG                       13884             38380\n  Muscle - Skeletal                                          602 MSCLSK                       13381             31855\n  Nerve - Tibial                                             449 NERVET                       15373             45478\n  Ovary                                                      140 OVARY                        13738             40857\n  Pancreas                                                   253 PNCREAS                      13695             31203\n  Pituitary                                                  219 PTTARY                       14647             42343\n  Prostate                                                   186 PRSTTE                       14450             41991\n  Skin - Not Sun Exposed (Suprapubic)                        440 SKINNS                       14932             42005\n  Skin - Sun Exposed (Lower leg)                             517 SKINS                        15204             42219\n  Small Intestine - Terminal Ileum                           144 SNTTRM                       14065             39864\n  Spleen                                                     186 SPLEEN                       14073             40290\n  Stomach                                                    269 STMACH                       14102             36624\n  Testis                                                     277 TESTIS                       17867             67784\n  Thyroid                                                    494 THYROID                      15303             45217\n  Uterus                                                     108 UTERUS                       13199             39485\n  Vagina                                                     122 VAGINA                       12969             36931\n  Whole Blood                                                573 WHLBLD                       12623             24568",
    "supporting": [
      "predictdb-weights-distribution_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}