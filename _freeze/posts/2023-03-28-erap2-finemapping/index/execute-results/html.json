{
  "hash": "aabd3abf9168a1138af3ce99a29d0d39",
  "result": {
    "markdown": "---\ntitle: \"ERAP2 fine-mapping\"\nauthor: \"Haky Im\"\ndate: \"2023-03-28\"\ncategories: [analysis,how_to]\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\neditor_options: \n  chunk_output_type: console\n---\n\n::: {.cell}\n\n```{.r .cell-code}\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n##PRE=\"/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data \"\n##PRE=\"/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data\"\n## COPY THE DATE AND SLUG fields FROM THE HEADER\nSLUG=\"erap2-fine-mapping\" ## copy the slug from the header\nbDATE='2023-03-28' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n## move data to DATA\n#tempodata=(\"~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv\")\n#system(glue::glue(\"cp {tempodata} {DATA}/\"))\n\n## system(glue(\"open {DATA}\")) ## this will open the folder \n```\n:::\n\n\nERAP2 fine-mapping results DAPG\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## query\n## SELECT * FROM `gtex-awg-im.GTEx_V8_DAPG.variants_pip_eqtl` where gene like \"ENSG00000164308%\"\nerap2 = read_csv(glue(\"{DATA}/bquxjob_41de6a2f_18728cf1999.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 2260 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): tissue, gene, variant_id\ndbl (4): rank, pip, log10_abvf, cluster_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n## SELECT * FROM `gtex-awg-im.GTEx_V8_DAPG.variants_pip_sqtl` where variant_id like \"chr5_96900192%\" order by pip desc\ntauras_snp = read_csv(glue(\"{DATA}/bquxjob_719c0131_18728db8878.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 113 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): tissue, gene_id, variant_id\ndbl (4): rank, pip, log10_abvf, cluster_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n## finemapping for the intron affected by chr5_96900192\n## SELECT * FROM `gtex-awg-im.GTEx_V8_DAPG.variants_pip_sqtl` where gene_id like \"intron_5_96900189_96901506\" order by pip desc\n\nintron = read_csv(glue(\"{DATA}/bquxjob_41bc6351_18728e4ee94.csv\"))\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nRows: 2439 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): tissue, gene_id, variant_id\ndbl (4): rank, pip, log10_abvf, cluster_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n```\n:::\n\n```{.r .cell-code}\n##\nintron %>% filter(tissue==\"Cells_EBV-transformed_lymphocytes\") %>% arrange(desc(pip))\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n# A tibble: 122 × 7\n   tissue                           gene_id  rank varia…¹    pip log10…² clust…³\n   <chr>                            <chr>   <dbl> <chr>    <dbl>   <dbl>   <dbl>\n 1 Cells_EBV-transformed_lymphocyt… intron…     2 chr5_9… 0.250     25.8       2\n 2 Cells_EBV-transformed_lymphocyt… intron…     1 chr5_9… 0.250     25.8       2\n 3 Cells_EBV-transformed_lymphocyt… intron…     3 chr5_9… 0.218     27.7       1\n 4 Cells_EBV-transformed_lymphocyt… intron…     4 chr5_9… 0.218     27.7       1\n 5 Cells_EBV-transformed_lymphocyt… intron…     5 chr5_9… 0.0902    27.7       1\n 6 Cells_EBV-transformed_lymphocyt… intron…     7 chr5_9… 0.0426    27.7       1\n 7 Cells_EBV-transformed_lymphocyt… intron…     6 chr5_9… 0.0426    27.7       1\n 8 Cells_EBV-transformed_lymphocyt… intron…     8 chr5_9… 0.0426    27.7       1\n 9 Cells_EBV-transformed_lymphocyt… intron…     9 chr5_9… 0.0380    25.8       2\n10 Cells_EBV-transformed_lymphocyt… intron…    10 chr5_9… 0.0371    25.8       2\n# … with 112 more rows, and abbreviated variable names ¹​variant_id,\n#   ²​log10_abvf, ³​cluster_id\n# ℹ Use `print(n = ...)` to see more rows\n```\n:::\n\n```{.r .cell-code}\n## \n\n## erap2 %>% filter(pip>0.1) %>% group_by(variant_id) %>% summarise(sumpip=sum(pip),ntissues=n()) %>% ggplot(aes(variant_id,sumpip)) + geom_bar(stat = \"identity\") + geom_point() + ggtitle(\"ERAP2 expr: most tissues assign pip to 16728 & 16885\")\n\nerap2 %>% filter(pip>0.1) %>% ggplot(aes(variant_id,pip)) + geom_violin() + geom_boxplot(width=0.05,alpha=0.5,outlier.shape = NA) + geom_point() + ggtitle(\"ERAP2 expr: most tissues assign pip to 16728 & 16885\") + ylim(0,NA)\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Groups with fewer than two data points have been dropped.\nGroups with fewer than two data points have been dropped.\nGroups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-1.png){width=672}\n:::\n\n```{.r .cell-code}\nprint(\"intron intron_5_96900189_96901506 \")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[1] \"intron intron_5_96900189_96901506 \"\n```\n:::\n\n```{.r .cell-code}\nintron %>% filter(pip>0.1) %>% ggplot(aes(variant_id,pip)) + geom_violin() + geom_boxplot(width=0.05,alpha=0.5,outlier.shape = NA) + geom_point() + ggtitle(\"ERAP2 intron_5_96900189_96901506:\") + ylim(0,NA) + coord_flip()\n```\n\n::: {.cell-output .cell-output-stderr}\n```\nWarning: Groups with fewer than two data points have been dropped.\nGroups with fewer than two data points have been dropped.\n```\n:::\n\n::: {.cell-output-display}\n![](index_files/figure-html/unnamed-chunk-2-2.png){width=672}\n:::\n\n```{.r .cell-code}\n#intron %>% filter(pip>0.1) %>% group_by(variant_id) %>% summarise(sumpip=sum(pip),ntissues=n()) %>% ggplot(aes(variant_id,sumpip)) + geom_bar(stat = \"identity\") + ggtitle(\"ERAP2 intron_5_96900189_96901506: \") + coord_flip()\n\n#ggplot(aes(variant_id,sumpip)) + geom_bar() \n```\n:::\n\n\nCausal SNP according to the black death paper and others is rs2248374 chr5_96900192\n",
    "supporting": [
      "index_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}