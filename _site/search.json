[
  {
    "objectID": "posts/migrating-instructions/index.html",
    "href": "posts/migrating-instructions/index.html",
    "title": "Migrating",
    "section": "",
    "text": "Here will come the list of migrating instructions\n\ncreate folder under post\nname the folder year-month-date-slug (slug=summary of title of the post)"
  },
  {
    "objectID": "posts/2023-03-01-gtex-sample-size-by-tissue/index.html",
    "href": "posts/2023-03-01-gtex-sample-size-by-tissue/index.html",
    "title": "gtex-sample-size-by-tissue",
    "section": "",
    "text": "GTEx Sample Size by Tissue\n\n\n\n\n\n\n\n\n\n\nname\neuropean samples\nabbreviation\nexpression models\nsplicing models\n\n\n\n\nAdipose - Subcutaneous\n491\nADPSBQ\n14732\n42912\n\n\nAdipose - Visceral (Omentum)\n401\nADPVSC\n14640\n41720\n\n\nAdrenal Gland\n200\nADRNLG\n13622\n36754\n\n\nArtery - Aorta\n338\nARTAORT\n14396\n40474\n\n\nArtery - Coronary\n180\nARTCRN\n13878\n40579\n\n\nArtery - Tibial\n489\nARTTBL\n14493\n40690\n\n\nBrain - Amygdala\n119\nBRNAMY\n12814\n24236\n\n\nBrain - Anterior cingulate cortex (BA24)\n135\nBRNACC\n13528\n28806\n\n\nBrain - Caudate (basal ganglia)\n172\nBRNCDT\n14118\n32127\n\n\nBrain - Cerebellar Hemisphere\n157\nBRNCHB\n13771\n39862\n\n\nBrain - Cerebellum\n188\nBRNCHA\n13992\n40747\n\n\nBrain - Cortex\n184\nBRNCTXA\n14284\n35086\n\n\nBrain - Frontal Cortex (BA9)\n158\nBRNCTXB\n14091\n32031\n\n\nBrain - Hippocampus\n150\nBRNHPP\n13526\n27437\n\n\nBrain - Hypothalamus\n157\nBRNHPT\n13741\n30326\n\n\nBrain - Nucleus accumbens (basal ganglia)\n181\nBRNNCC\n14062\n32670\n\n\nBrain - Putamen (basal ganglia)\n153\nBRNPTM\n13694\n28461\n\n\nBrain - Spinal cord (cervical c-1)\n115\nBRNSPC\n13096\n28883\n\n\nBrain - Substantia nigra\n101\nBRNSNG\n12637\n23677\n\n\nBreast - Mammary Tissue\n337\nBREAST\n14654\n44613\n\n\nCells - Cultured fibroblasts\n417\nFIBRBLS\n13976\n36809\n\n\nCells - EBV-transformed lymphocytes\n116\nLCL\n12398\n37627\n\n\nColon - Sigmoid\n274\nCLNSGM\n14363\n41581\n\n\nColon - Transverse\n306\nCLNTRN\n14582\n41215\n\n\nEsophagus - Gastroesophageal Junction\n281\nESPGEJ\n14285\n41004\n\n\nEsophagus - Mucosa\n423\nESPMCS\n14589\n37186\n\n\nEsophagus - Muscularis\n399\nESPMSL\n14603\n40376\n\n\nHeart - Atrial Appendage\n322\nHRTAA\n14035\n36322\n\n\nHeart - Left Ventricle\n334\nHRTLV\n13200\n29470\n\n\nKidney - Cortex\n65\nKDNCTX\n11164\n24571\n\n\nLiver\n183\nLIVER\n12714\n27011\n\n\nLung\n444\nLUNG\n15058\n44346\n\n\nMinor Salivary Gland\n119\nSLVRYG\n13884\n38380\n\n\nMuscle - Skeletal\n602\nMSCLSK\n13381\n31855\n\n\nNerve - Tibial\n449\nNERVET\n15373\n45478\n\n\nOvary\n140\nOVARY\n13738\n40857\n\n\nPancreas\n253\nPNCREAS\n13695\n31203\n\n\nPituitary\n219\nPTTARY\n14647\n42343\n\n\nProstate\n186\nPRSTTE\n14450\n41991\n\n\nSkin - Not Sun Exposed (Suprapubic)\n440\nSKINNS\n14932\n42005\n\n\nSkin - Sun Exposed (Lower leg)\n517\nSKINS\n15204\n42219\n\n\nSmall Intestine - Terminal Ileum\n144\nSNTTRM\n14065\n39864\n\n\nSpleen\n186\nSPLEEN\n14073\n40290\n\n\nStomach\n269\nSTMACH\n14102\n36624\n\n\nTestis\n277\nTESTIS\n17867\n67784\n\n\nThyroid\n494\nTHYROID\n15303\n45217\n\n\nUterus\n108\nUTERUS\n13199\n39485\n\n\nVagina\n122\nVAGINA\n12969\n36931\n\n\nWhole Blood\n573\nWHLBLD\n12623\n24568"
  },
  {
    "objectID": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html",
    "href": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html",
    "title": "Power calculator for mol QTLs",
    "section": "",
    "text": "The success of the prediction training depends mostly on whether the corresponding QTL study will be powered. Thus, we provide here the power to detect molecular QTLs for a range of sample sizes, effect sizes, and minor allele frequencies."
  },
  {
    "objectID": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#function-r2-from-beta-assuming-variance-of-y-1",
    "href": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#function-r2-from-beta-assuming-variance-of-y-1",
    "title": "Power calculator for mol QTLs",
    "section": "function: R2 from beta assuming variance of y = 1",
    "text": "function: R2 from beta assuming variance of y = 1\n\\[y = \\delta \\cdot x + \\epsilon\\]\n\\[r^2 = \\delta^2 \\cdot \\text{var}(x) = \\delta^2 \\cdot 2 \\cdot \\text{maf} \\cdot (1-\\text{maf})\\]\n\n\nShow the code\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(knitr))\n## install.packages(\"pwr\")\nif (!(\"pwr\" %in% installed.packages()[, 1])) {\n  install.packages(\"pwr\")\n}"
  },
  {
    "objectID": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#define-ranges-of-maf-eff-sample-sizes",
    "href": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#define-ranges-of-maf-eff-sample-sizes",
    "title": "Power calculator for mol QTLs",
    "section": "define ranges of maf, eff, sample sizes",
    "text": "define ranges of maf, eff, sample sizes\n\n\nShow the code\nmafvec = c(0.05, 0.10, 0.30) \neffvec = c(0.40, 0.60, 0.80) \nnvec = c(200,350,500) \nnsnps = 1000\nalpha = 0.05/nsnps"
  },
  {
    "objectID": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#create-data-frame-with-all-combinations",
    "href": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#create-data-frame-with-all-combinations",
    "title": "Power calculator for mol QTLs",
    "section": "create data frame with all combinations",
    "text": "create data frame with all combinations\n\n\nShow the code\n# mat = matrix(NA,length(mafvec)*length(effvec)*length(nvec),4)\n# colnames(mat) = c(\"maf\",\"eff\",\"nsam\",\"power\")\n# cont = 1\n# for(maf in mafvec)\n# {\n#   for(nn in nvec)\n#   {\n#     for(eff in effvec)\n#     {\n#       r2 = eff^2 * 2 * maf * (1-maf)\n#       rr = sqrt(r2)\n#       pp = pwr::pwr.r.test(n = nn, r= rr , sig.level = alpha)\n#       mat[cont,] = c(maf, eff, nn, pp$power)\n#       cont = cont + 1\n#     }\n#   }\n# }\n# \n# mat %>% data.frame() %>% \n#   pivot_wider(names_from = nsam, values_from = power) %>% \n#   mutate(across(3:ncol(.), ~sprintf(\"%.1f%%\", . * 100))) %>% \n#   kable(format = \"markdown\", align = c(\"l\", \"l\", \"c\", \"c\", \"c\"), \n#         caption = \"Power by sample size\")"
  },
  {
    "objectID": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#calculate-detectable-effect-sizes",
    "href": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#calculate-detectable-effect-sizes",
    "title": "Power calculator for mol QTLs",
    "section": "calculate detectable effect sizes",
    "text": "calculate detectable effect sizes\nThe following table shows the detectable effect sizes at 80% power with a significance level of 0.05/1000. Variance of Y is standardized to 1.\n\n\nShow the code\ncalc_mateff = function(mafvec,nvec,outmat=FALSE)\n{\n  mateff = matrix(NA,length(mafvec)*length(nvec),3)\ncolnames(mateff) = c(\"maf\",\"nsam\",\"power\")\ncont = 1\nfor(maf in mafvec)\n{\n  for(nn in nvec)\n  {\n      # r2 = eff^2 * 2 * maf * (1-maf)\n      # rr = sqrt(r2)\n      pp = pwr::pwr.r.test(n = nn, power=0.80 , sig.level = alpha)\n      eff = pp$r/sqrt(2*maf*(1-maf))\n      mateff[cont,] = c(maf,  nn, eff)\n      cont = cont + 1\n  }\n}\n  mateff = mateff %>% data.frame() %>% \n  pivot_wider(names_from = nsam, values_from = power) %>% \n  mutate_at(vars(-c(1)), ~round(., 2)) \n  print(mateff)\n  if(outmat) mateff\n} \n\nmafvec = c(0.05, 0.10, 0.30) \nnvec = c(100,500,1000,7000) \nnsnps = 1000\nalpha = 0.05/nsnps\n## ---\nmat = calc_mateff(mafvec,nvec,outmat=TRUE)\n\n\n# A tibble: 3 × 5\n    maf `100` `500` `1000` `7000`\n  <dbl> <dbl> <dbl>  <dbl>  <dbl>\n1  0.05  1.5   0.7    0.5    0.19\n2  0.1   1.09  0.51   0.36   0.14\n3  0.3   0.71  0.33   0.24   0.09\n\n\nShow the code\nmat %>%  kable(format = \"markdown\", align = c(\"l\", \"c\", \"c\", \"c\", \"c\"), caption = \"Detectable effects w/1000 SNPs\",label=NA) \n\n\n\nDetectable effects w/1000 SNPs\n\n\nmaf\n100\n500\n1000\n7000\n\n\n\n\n0.05\n1.50\n0.70\n0.50\n0.19\n\n\n0.10\n1.09\n0.51\n0.36\n0.14\n\n\n0.30\n0.71\n0.33\n0.24\n0.09\n\n\n\n\n\nShow the code\nmafvec = c(0.05, 0.10, 0.30) \nnvec = c(1000,6000,10000,100000) \nnsnps = 1e6\nalpha = 0.05/nsnps\n## ---\nmat = calc_mateff(mafvec,nvec,outmat=TRUE)\n\n\n# A tibble: 3 × 5\n    maf `1000` `6000` `10000` `1e+05`\n  <dbl>  <dbl>  <dbl>   <dbl>   <dbl>\n1  0.05   0.64   0.26    0.2     0.06\n2  0.1    0.46   0.19    0.15    0.05\n3  0.3    0.3    0.13    0.1     0.03\n\n\nShow the code\nmat %>%  kable(format = \"markdown\", align = c(\"l\", \"c\", \"c\", \"c\", \"c\"), caption = \"Detectable effects w/1e6 SNPs\",label=NA) \n\n\n\nDetectable effects w/1e6 SNPs\n\n\nmaf\n1000\n6000\n10000\n1e+05\n\n\n\n\n0.05\n0.64\n0.26\n0.20\n0.06\n\n\n0.10\n0.46\n0.19\n0.15\n0.05\n\n\n0.30\n0.30\n0.13\n0.10\n0.03"
  },
  {
    "objectID": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#power-for-xcan-association-continuous-x",
    "href": "posts/2023-02-21-power-calculator-for-mol-qtls/index.html#power-for-xcan-association-continuous-x",
    "title": "Power calculator for mol QTLs",
    "section": "power for Xcan association (continuous X)",
    "text": "power for Xcan association (continuous X)\n\n\nShow the code\nnvec = c(10000,100000,500000) \nntests = 10000\nalpha = 0.05/ntests\n\ncalc_matr = function(nvec,outmat=FALSE)\n{\n  mateff = matrix(NA,length(nvec),2)\n  colnames(mateff) = c(\"nsam\",\"r\")\n  cont = 1\n  for(nn in nvec)\n  {\n    pp = pwr::pwr.r.test(n = nn, power=0.80 , sig.level = alpha)\n    mateff[cont,] = c(nn, pp$r)\n    cont = cont + 1\n  }\n  mateff = mateff %>% data.frame() %>%  mutate(r2 = r^2) %>% mutate_at(vars(-c(1)), ~signif(., 2)) \n  print(mateff)\n  if(outmat) mateff\n} \n\ncalc_matr(nvec,outmat=TRUE) %>% knitr::kable()\n\n\n   nsam      r      r2\n1 1e+04 0.0540 2.9e-03\n2 1e+05 0.0170 2.9e-04\n3 5e+05 0.0077 5.9e-05\n\n\n\n\n\nnsam\nr\nr2\n\n\n\n\n1e+04\n0.0540\n2.9e-03\n\n\n1e+05\n0.0170\n2.9e-04\n\n\n5e+05\n0.0077\n5.9e-05\n\n\n\n\n\nWith sample sizes of {`r nvec}, we can detect genes that affect"
  },
  {
    "objectID": "posts/2023-03-01-how-to-create-new-posts/index.html",
    "href": "posts/2023-03-01-how-to-create-new-posts/index.html",
    "title": "PredictDB weight distribution",
    "section": "",
    "text": "create a new folder under post/new_folder\nname the folder with year-month-date-slug, 2023-03-02-descriptive-title\ncreate a file named index.qmd and add the following header, update the title, your name and the date\n\n---\ntitle: \"PredictDB weight distribution\"\nauthor: \"Your Name\"\ndate: \"2023-02-28\"\ncategories: [analysis,how_to]\nformat:\n  html:\n    code-fold: true\n    code-summary: \"Show the code\"\n---\n\ncopy file to box so that the analysis can be reproducible\n\n\n\nShow the code\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n##PRE=\"/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data \"\n##PRE=\"/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data\"\n## COPY THE DATE AND SLUG fields FROM THE HEADER\nSLUG=\"predictdb-weight-distribution\" ## copy the slug from the header\nbDATE='2023-02-28' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n## move data to DATA\n#tempodata=(\"~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv\")\n#system(glue::glue(\"cp {tempodata} {DATA}/\"))\nsystem(glue(\"open {DATA}\")) ## this will open the folder"
  },
  {
    "objectID": "posts/2023-03-28-erap2-finemapping/index.html",
    "href": "posts/2023-03-28-erap2-finemapping/index.html",
    "title": "ERAP2 fine-mapping",
    "section": "",
    "text": "Show the code\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n##PRE=\"/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data \"\n##PRE=\"/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data\"\n## COPY THE DATE AND SLUG fields FROM THE HEADER\nSLUG=\"erap2-fine-mapping\" ## copy the slug from the header\nbDATE='2023-03-28' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n## move data to DATA\n#tempodata=(\"~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv\")\n#system(glue::glue(\"cp {tempodata} {DATA}/\"))\n\n## system(glue(\"open {DATA}\")) ## this will open the folder \n\n\nERAP2 fine-mapping results DAPG\n\n\nShow the code\n## query\n## SELECT * FROM `gtex-awg-im.GTEx_V8_DAPG.variants_pip_eqtl` where gene like \"ENSG00000164308%\"\nerap2 = read_csv(glue(\"{DATA}/bquxjob_41de6a2f_18728cf1999.csv\"))\n\n\nRows: 2260 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): tissue, gene, variant_id\ndbl (4): rank, pip, log10_abvf, cluster_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nShow the code\n## SELECT * FROM `gtex-awg-im.GTEx_V8_DAPG.variants_pip_sqtl` where variant_id like \"chr5_96900192%\" order by pip desc\ntauras_snp = read_csv(glue(\"{DATA}/bquxjob_719c0131_18728db8878.csv\"))\n\n\nRows: 113 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): tissue, gene_id, variant_id\ndbl (4): rank, pip, log10_abvf, cluster_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nShow the code\n## finemapping for the intron affected by chr5_96900192\n## SELECT * FROM `gtex-awg-im.GTEx_V8_DAPG.variants_pip_sqtl` where gene_id like \"intron_5_96900189_96901506\" order by pip desc\n\nintron = read_csv(glue(\"{DATA}/bquxjob_41bc6351_18728e4ee94.csv\"))\n\n\nRows: 2439 Columns: 7\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): tissue, gene_id, variant_id\ndbl (4): rank, pip, log10_abvf, cluster_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nShow the code\n##\nintron %>% filter(tissue==\"Cells_EBV-transformed_lymphocytes\") %>% arrange(desc(pip))\n\n\n# A tibble: 122 × 7\n   tissue                           gene_id  rank varia…¹    pip log10…² clust…³\n   <chr>                            <chr>   <dbl> <chr>    <dbl>   <dbl>   <dbl>\n 1 Cells_EBV-transformed_lymphocyt… intron…     2 chr5_9… 0.250     25.8       2\n 2 Cells_EBV-transformed_lymphocyt… intron…     1 chr5_9… 0.250     25.8       2\n 3 Cells_EBV-transformed_lymphocyt… intron…     3 chr5_9… 0.218     27.7       1\n 4 Cells_EBV-transformed_lymphocyt… intron…     4 chr5_9… 0.218     27.7       1\n 5 Cells_EBV-transformed_lymphocyt… intron…     5 chr5_9… 0.0902    27.7       1\n 6 Cells_EBV-transformed_lymphocyt… intron…     7 chr5_9… 0.0426    27.7       1\n 7 Cells_EBV-transformed_lymphocyt… intron…     6 chr5_9… 0.0426    27.7       1\n 8 Cells_EBV-transformed_lymphocyt… intron…     8 chr5_9… 0.0426    27.7       1\n 9 Cells_EBV-transformed_lymphocyt… intron…     9 chr5_9… 0.0380    25.8       2\n10 Cells_EBV-transformed_lymphocyt… intron…    10 chr5_9… 0.0371    25.8       2\n# … with 112 more rows, and abbreviated variable names ¹​variant_id,\n#   ²​log10_abvf, ³​cluster_id\n# ℹ Use `print(n = ...)` to see more rows\n\n\nShow the code\n## \n\n## erap2 %>% filter(pip>0.1) %>% group_by(variant_id) %>% summarise(sumpip=sum(pip),ntissues=n()) %>% ggplot(aes(variant_id,sumpip)) + geom_bar(stat = \"identity\") + geom_point() + ggtitle(\"ERAP2 expr: most tissues assign pip to 16728 & 16885\")\n\nerap2 %>% filter(pip>0.1) %>% ggplot(aes(variant_id,pip)) + geom_violin() + geom_boxplot(width=0.05,alpha=0.5,outlier.shape = NA) + geom_point() + ggtitle(\"ERAP2 expr: most tissues assign pip to 16728 & 16885\") + ylim(0,NA)\n\n\nWarning: Groups with fewer than two data points have been dropped.\nGroups with fewer than two data points have been dropped.\nGroups with fewer than two data points have been dropped.\n\n\n\n\n\nShow the code\nprint(\"intron intron_5_96900189_96901506 \")\n\n\n[1] \"intron intron_5_96900189_96901506 \"\n\n\nShow the code\nintron %>% filter(pip>0.1) %>% ggplot(aes(variant_id,pip)) + geom_violin() + geom_boxplot(width=0.05,alpha=0.5,outlier.shape = NA) + geom_point() + ggtitle(\"ERAP2 intron_5_96900189_96901506:\") + ylim(0,NA) + coord_flip()\n\n\nWarning: Groups with fewer than two data points have been dropped.\nGroups with fewer than two data points have been dropped.\n\n\n\n\n\nShow the code\n#intron %>% filter(pip>0.1) %>% group_by(variant_id) %>% summarise(sumpip=sum(pip),ntissues=n()) %>% ggplot(aes(variant_id,sumpip)) + geom_bar(stat = \"identity\") + ggtitle(\"ERAP2 intron_5_96900189_96901506: \") + coord_flip()\n\n#ggplot(aes(variant_id,sumpip)) + geom_bar() \n\n\nCausal SNP according to the black death paper and others is rs2248374 chr5_96900192"
  },
  {
    "objectID": "posts/2023-02-28-predictdb-weights-distribution/index.html",
    "href": "posts/2023-02-28-predictdb-weights-distribution/index.html",
    "title": "PredictDB weight distribution",
    "section": "",
    "text": "Goal: get effect size distribution of omic traits\n\n\nShow the code\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n##PRE=\"/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data \"\n##PRE=\"/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data\"\n## COPY THE DATE AND SLUG fields FROM THE HEADER\nSLUG=\"predictdb-weight-distribution\" ## copy the slug from the header\nbDATE='2023-02-28' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\nUSERNAME=\"haekyungim\"\n## move data to DATA\n#tempodata=(\"~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv\")\n#system(glue::glue(\"cp {tempodata} {DATA}/\"))\n## system(glue(\"open {DATA}\")) ## this will open the folder \n\n\n\ndownload mashr gtex v8 prediction models for various\n\n\n\nShow the code\nif(F)\n{\n  setwd(DATA)\n  system(glue(\"wget https://zenodo.org/record/3518299/files/mashr_eqtl.tar?download=1\"))\n  system(glue(\"tar xvf mashr_eqtl.tar\"))\n  system(glue(\"cd eqtl\"))\n  system(\"rm *.txt.gz\")\n}\n\n\n\nplot distribution, show summary\n\n\n\nShow the code\nlibrary(\"RSQLite\")\nsqlite <- dbDriver(\"SQLite\")\n\nmyshowdist = function(dbname,titulo=\"n=\")\n{\nprint(dbname)\ndb = dbConnect(sqlite,dbname)\nweights = dbGetQuery(db, \"select * from weights\")\nabsweivec = abs(weights$weight)\nqlines = quantile(absweivec,c(0.2,0.5)) %>% round(2)\nquantile(absweivec,(0:10)/10) %>% round(2) %>% print()\npp <- weights %>% mutate(abswei=abs(weight)) %>% ggplot(aes(abswei))+geom_histogram() + geom_vline(xintercept=qlines) +ggtitle(glue(\"{titulo}; 20%={qlines[1]}, median={qlines[2]}\"))\nprint(pp)\ndbDisconnect(db)\n}\n\n\n\nread weights adipose with 491 samples\n\n\n\nShow the code\ndbname <- glue(\"{DATA}/eqtl/mashr_Adipose_Subcutaneous.db\") ## add full path if db file not in current directory\nmyshowdist(dbname,titulo=\"Adipose expr n=491\")\n\n\n/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data/2023-02-28-predictdb-weight-distribution/eqtl/mashr_Adipose_Subcutaneous.db\n  0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% \n0.00 0.02 0.05 0.08 0.12 0.15 0.20 0.25 0.34 0.50 2.47 \n\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nread weights brain substantia nigra with 101 samples\n\n\n\nShow the code\ndbname <- glue(\"{DATA}/eqtl/mashr_Brain_Substantia_nigra.db\") ## add full path if db file not in current directory\nmyshowdist(dbname,titulo=\"Brain SN expr - n=101\")\n\n\n/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data/2023-02-28-predictdb-weight-distribution/eqtl/mashr_Brain_Substantia_nigra.db\n  0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% \n0.00 0.01 0.02 0.04 0.07 0.10 0.14 0.20 0.29 0.44 2.56 \n\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nread protein prediction weights\n\n\n\nShow the code\n## can download from https://uchicago.box.com/shared/static/m3zsxy3oy8kn5gkktkuo8lvui269hxi5.db\nprint(\"AA\")\n\n\n[1] \"AA\"\n\n\nShow the code\ndbname <- glue::glue(\"/Users/{USERNAME}/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/Within-Lab-Sharing/Sabrina-Data/ARIC/ARIC_AA_hg38.db\")\nmyshowdist(dbname,titulo=\"protein ARIC AA n=1,871\")\n\n\n/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/Within-Lab-Sharing/Sabrina-Data/ARIC/ARIC_AA_hg38.db\n  0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% \n0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.01 0.02 0.03 0.59 \n\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\n\nShow the code\n## can download from https://uchicago.box.com/shared/static/m3zsxy3oy8kn5gkktkuo8lvui269hxi5.db\nprint(\"EUR\")\n\n\n[1] \"EUR\"\n\n\nShow the code\ndbname <- glue::glue(\"/Users/{USERNAME}/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/Within-Lab-Sharing/Sabrina-Data/ARIC/ARIC_EA_hg38.db\")\nmyshowdist(dbname,titulo=\"protein ARIC EA n=7,213\")\n\n\n/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/Within-Lab-Sharing/Sabrina-Data/ARIC/ARIC_EA_hg38.db\n  0%  10%  20%  30%  40%  50%  60%  70%  80%  90% 100% \n0.00 0.00 0.00 0.00 0.00 0.01 0.01 0.01 0.01 0.03 0.55 \n\n\n`stat_bin()` using `bins = 30`. Pick better value with `binwidth`.\n\n\n\n\n\n\nread brainxcan weights (use elastic net to be closer to QTL effect size)\n\n\n\nShow the code\n##install.packages(\"arrow\")\ntempo = arrow::read_parquet(glue::glue(\"{DATA}/brainxcan-gw_lasso_beta.parquet\"))\ntempo = as.matrix(tempo %>% select(starts_with(\"IDP\")))\nkk = abs(tempo[tempo!=0])\nprint(summary(kk))\n\n\n     Min.   1st Qu.    Median      Mean   3rd Qu.      Max. \n0.0000000 0.0003630 0.0009091 0.0013655 0.0018487 0.0652540 \n\n\nShow the code\nprint(quantile(kk,(0:10)/10))\n\n\n          0%          10%          20%          30%          40%          50% \n1.513009e-11 1.207948e-04 2.761802e-04 4.559484e-04 6.659417e-04 9.090500e-04 \n         60%          70%          80%          90%         100% \n1.205991e-03 1.594788e-03 2.162211e-03 3.165862e-03 6.525400e-02 \n\n\nShow the code\nprint(quantile(kk,c(0.2,0.5)))\n\n\n         20%          50% \n0.0002761802 0.0009090500"
  },
  {
    "objectID": "posts/2023-03-23-jane-austen-corpus/index.html",
    "href": "posts/2023-03-23-jane-austen-corpus/index.html",
    "title": "Jane Austen Corpus",
    "section": "",
    "text": "Show the code\nsuppressMessages(library(tidyverse))\nsuppressMessages(library(glue))\nPRE = \"/Users/haekyungim/Library/CloudStorage/Box-Box/LargeFiles/imlab-data/data-Github/web-data\"\n##PRE=\"/Users/margaretperry/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data \"\n##PRE=\"/Users/temi/Library/CloudStorage/Box-Box/imlab-data/data-Github/web-data\"\n## COPY THE DATE AND SLUG fields FROM THE HEADER\nSLUG=\"jane-austen-corpus\" ## copy the slug from the header\nbDATE='2023-03238' ## copy the date from the blog's header here\nDATA = glue(\"{PRE}/{bDATE}-{SLUG}\")\nif(!file.exists(DATA)) system(glue::glue(\"mkdir {DATA}\"))\nWORK=DATA\n\n## move data to DATA\n#tempodata=(\"~/Downloads/tempo/gwas_catalog_v1.0.2-associations_e105_r2022-04-07.tsv\")\n#system(glue::glue(\"cp {tempodata} {DATA}/\"))\nsystem(glue(\"open {DATA}\")) ## this will open the folder \n\n\n\nget jane austen corpus\n\n\n\nShow the code\n##install.packages(\"janeaustenr\")"
  },
  {
    "objectID": "about.html",
    "href": "about.html",
    "title": "About",
    "section": "",
    "text": "About this blog"
  }
]